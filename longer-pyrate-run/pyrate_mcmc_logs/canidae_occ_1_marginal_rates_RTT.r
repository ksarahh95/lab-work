# 1 files combined:
# 	/home/eeb177-student/Desktop/eeb-177/Lab-Work/exercise-9/longer-pyrate-run/pyrate_mcmc_logs/canidae_occ_1_marginal_rates.log

# 95% HPDs calculated using code from Biopy (https://www.cs.auckland.ac.nz/~yhel002/biopy/)

pdf(file='/home/eeb177-student/Desktop/eeb-177/Lab-Work/exercise-9/longer-pyrate-run/pyrate_mcmc_logs/canidae_occ_1_marginal_rates_RTT.pdf',width=0.6*9, height=16.8)
par(mfrow=c(4,1))
library(scales)
L_hpd_m95=c(0.141946815878, 0.141946815878,0.141946815878,0.141302166002,0.138634305615,0.0726780830078,0.0430823616905,0.0350733668099,0.0425723509035,0.0436777292732,0.0421319015918,0.0421319015918,0.0425723509035,0.0436777292732,0.0469666262416,0.0469440717413,0.0525683853429,0.0576126494059,0.0614625189304,0.0708790563191,0.0829410440454,0.0956300297641,0.0984703639187,0.0985786778614,0.0988706200959,0.0991585616737,0.0999162211395,0.0985786778614,0.0949760974445,0.0989928382674,0.0943940228697,0.110298439363,0.130324821488,0.139248520731,0.141421116063,0.14412079893,0.141421116063,0.131136839761,0.131313609546,0.132702856614,0.132254416542,0.128945743668,0.129318193308,0.130324821488,0.130324821488,0.128945743668,0.121902631743,0.121719929734,0.130324821488,0.130324821488)
L_hpd_M95=c(0.334182291633, 0.334182291633,0.334542200776,0.334182291633,0.337488883199,0.329692790186,0.262461507331,0.149201988631,0.139451294053,0.139309104861,0.137235436349,0.137058091476,0.137058091476,0.138900497199,0.143849645824,0.147741901264,0.167505068219,0.175354749406,0.181619960813,0.199780395961,0.207925903114,0.208871884137,0.209564759366,0.209243278289,0.210574297319,0.211317666966,0.213464917604,0.214093306463,0.220223693336,0.244534015926,0.296288843974,0.407490409255,0.42597064006,0.434115104901,0.436682312777,0.434115104901,0.434115104901,0.422834045618,0.423047822235,0.423047822235,0.423047822235,0.423861882358,0.425459288834,0.429378727109,0.433119570192,0.438080779605,0.433290138847,0.433626903984,0.444407341089,0.445663714154)
M_hpd_m95=c(0.815181810327, 0.815181810327,0.0947055181172,0.0947055181172,0.0962751170782,0.0947055181172,0.0947055181172,0.0949435087665,0.0926701004386,0.0936615998404,0.0936615998404,0.0936615998404,0.0948898296755,0.0936615998404,0.0926701004386,0.0919899123727,0.0903401011669,0.0886436913626,0.0886436913626,0.0863499253481,0.0863499253481,0.0814240653791,0.0565824602892,0.0555337465763,0.049992622557,0.0482919952678,0.0485214338524,0.0456786387956,0.0439452713436,0.0439452713436,0.0455014570699,0.0439452713436,0.0417505289724,0.0420960670895,0.0396809991067,0.0396809991067,0.0370142823046,0.0370142823046,0.03472116911,0.0370142823046,0.0370142823046,0.03472116911,0.03472116911,0.0312404017748,0.0236960492658,0.0197752441126,0.025844972757,0.0244891379295,0.0244891379295,0.0244891379295)
M_hpd_M95=c(1.43717696451, 1.43717696451,0.172883323221,0.172677871212,0.174417009837,0.172677871212,0.170967762461,0.161782194075,0.153821000452,0.150578266492,0.148609100707,0.147678528424,0.149152937666,0.147678528424,0.147075432152,0.147160149469,0.147513619279,0.146831869154,0.147160149469,0.145023515524,0.145877776341,0.146022806551,0.140034993282,0.138680690769,0.132411340667,0.129663455269,0.128721714665,0.124207609283,0.120620970559,0.116488440322,0.11620560525,0.114543502166,0.112661261016,0.115847531093,0.115988596553,0.118186175091,0.116869299517,0.119885228552,0.119885228552,0.131121132339,0.13330335239,0.136108605913,0.141637760024,0.145664297856,0.154350441416,0.158523287657,0.165646351287,0.166592997353,0.166592997353,0.166592997353)
R_hpd_m95=c(-1.21604562517, -1.21604562517,0.0228636399631,0.0160443635856,0.0130054403083,-0.0500458452388,-0.0976349185649,-0.107364610878,-0.0947210643659,-0.0852007233524,-0.0852007233524,-0.0833580110115,-0.0833580110115,-0.0833580110115,-0.0851871719543,-0.0801862649936,-0.0792609475601,-0.0732008007615,-0.0718179402986,-0.0543249645477,-0.042595783702,-0.0288449750455,-0.0209904491999,-0.0207553399752,-0.0108652445248,-0.0068771463911,-0.00157495935317,-0.001460136835,-0.001460136835,-0.001460136835,0.000777458715241,0.0236412585807,0.0475327340245,0.0590382382122,0.0615264140571,0.0615264140571,0.052966245328,0.0539694288279,0.0514077514487,0.0471643778016,0.0471643778016,0.0366667877496,0.0366667877496,0.0365121319598,0.0168894852912,0.0242012814006,0.0183716936357,0.0183716936357,0.0130054403083,0.0118224989948)
R_hpd_M95=c(-0.560020587743, -0.560020587743,0.219074644744,0.21308936128,0.216711506008,0.209070881703,0.157179857875,0.0412681037682,0.0245742273838,0.0279537511149,0.0268088350937,0.0268755437449,0.0268755437449,0.0279537511149,0.0284159030495,0.0372109147727,0.0531482781346,0.063563279707,0.0683059257916,0.0877449211425,0.0933634889574,0.0998156533384,0.119279232158,0.124570570526,0.136572389237,0.137462146412,0.142250224693,0.142946331458,0.153597527158,0.176327943619,0.232044839388,0.33784163637,0.355331940451,0.368487559085,0.36930795449,0.362702780184,0.3553503238,0.358798276056,0.358798276056,0.358456310261,0.358767011973,0.354224613588,0.36199821371,0.370942388306,0.376263434829,0.395418519369,0.393491566648,0.397797058893,0.393491566648,0.393491566648)
L_mean=c(0.257179636645, 0.257179636645,0.25733296389,0.257229450749,0.255652548965,0.236740630061,0.110311314402,0.0891159728805,0.085748312817,0.0852369962524,0.0851678603124,0.0851246027372,0.0851336185996,0.0854348112779,0.0863734979633,0.0882013156882,0.103236392105,0.114116270359,0.119401638889,0.137814609997,0.147372067084,0.152083808096,0.15284209137,0.152938952263,0.153120731062,0.153223607791,0.153740813815,0.154483979352,0.156902411093,0.161472083272,0.176028363221,0.250767224879,0.276938091528,0.283626526366,0.285908946117,0.28442825188,0.283301246211,0.282640397174,0.282466151315,0.280636087668,0.279848306291,0.280236471142,0.279494112261,0.279550010751,0.281073553634,0.282418704582,0.282992543579,0.2837939744,0.284132009524,0.284592519145)
M_mean=c(1.11797736949, 1.11797736949,0.127789343695,0.127657165791,0.127627274324,0.127588496019,0.127186549494,0.12508717579,0.12331232431,0.121713011399,0.121048288859,0.120576222742,0.120495925648,0.120431226853,0.119742138077,0.118831906023,0.118212337792,0.117925156455,0.117793477554,0.117694749928,0.117870409396,0.116502496835,0.10630014774,0.09881576888,0.09175612162,0.0859672709365,0.0833413444293,0.0823568756134,0.0804961923269,0.0779038718553,0.0772773672821,0.0768998935184,0.0768391350703,0.0771320734597,0.0765941932475,0.0765984314197,0.0765010687846,0.0764360824063,0.0765823593617,0.0778560519602,0.0783384474676,0.079207603413,0.0802863499325,0.0818334998264,0.0849865516857,0.0858857305561,0.0860253453357,0.0863403199915,0.0863403199915,0.0863403199915)
R_mean=c(-0.860797732849, -0.860797732849,0.129543620195,0.129572284958,0.12802527464,0.109152134042,-0.0168752350926,-0.0359712029097,-0.0375640114933,-0.0364760151466,-0.0358804285463,-0.0354516200043,-0.0353623070484,-0.0349964155747,-0.0333686401136,-0.0306305903345,-0.0149759456864,-0.00380888609596,0.00160816133504,0.0201198600687,0.029501657688,0.0355813112604,0.0465419436302,0.0541231833831,0.0613646094417,0.0672563368547,0.0703994693857,0.0721271037388,0.0764062187656,0.0835682114171,0.0987509959392,0.173867331361,0.200098956457,0.206494452907,0.209314752869,0.207829820461,0.206800177426,0.206204314768,0.205883791954,0.202780035708,0.201509858823,0.201028867729,0.199207762328,0.197716510925,0.196087001949,0.196532974026,0.196967198243,0.197453654408,0.197791689532,0.198252199153)
trans=0.5
age=(0:(50-1))* -1
plot(age,age,type = 'n', ylim = c(0, 0.490230085569), xlim = c(-52.5,2.5), ylab = 'Speciation rate', xlab = 'Ma',main='canidae' )
polygon(c(age, rev(age)), c(L_hpd_M95, rev(L_hpd_m95)), col = alpha("#4c4cec",trans), border = NA)
lines(rev(age), rev(L_mean), col = "#4c4cec", lwd=3)
plot(age,age,type = 'n', ylim = c(0, 1.58089466096), xlim = c(-52.5,2.5), ylab = 'Extinction rate', xlab = 'Ma' )
polygon(c(age, rev(age)), c(M_hpd_M95, rev(M_hpd_m95)), col = alpha("#e34a33",trans), border = NA)
lines(rev(age), rev(M_mean), col = "#e34a33", lwd=3)
plot(age,age,type = 'n', ylim = c(-1.33765018769, 0.437576764783), xlim = c(-52.5,2.5), ylab = 'Net diversification rate', xlab = 'Ma' )
abline(h=0,lty=2,col="darkred")
polygon(c(age, rev(age)), c(R_hpd_M95, rev(R_hpd_m95)), col = alpha("#504A4B",trans), border = NA)
lines(rev(age), rev(R_mean), col = "#504A4B", lwd=3)
plot(age,age,type = 'n', ylim = c(0, max(1/M_mean)), xlim = c(-52.5,2.5), ylab = 'Longevity (Myr)', xlab = 'Ma' )
lines(rev(age), rev(1/M_mean), col = "#504A4B", lwd=3)
n <- dev.off()